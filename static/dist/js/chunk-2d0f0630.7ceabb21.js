(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0f0630"],{"9bc4":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("CCardBody",[a("CDataTable",{attrs:{items:e.formatItems,fields:e.fields,"items-per-page":e.perPage,"column-filter":"",hover:"",sorter:e.sorter},on:{"page-change":e.onPageChange,"update:sorter-value":e.onSorterValue,"update:column-filter-value":e.onColumnFilterValue},scopedSlots:e._u([{key:"over-table",fn:function(){return[a("CButton",{staticClass:"btn btn-primary",on:{click:e.showModal}},[e._v("新增")])]},proxy:!0},{key:"status",fn:function(t){var o=t.item;return[a("td",[a("CBadge",{attrs:{color:e.getBadge(o.status)}},[e._v(" "+e._s(o.status)+" ")])],1)]}},{key:"action",fn:function(t){var o=t.item,n=t.index;return[a("td",{staticClass:"py-2"},[a("CButton",{attrs:{color:"primary",variant:"outline",square:"",size:"sm"},on:{click:function(t){return e.editBusinessCode(o,n)}}},[e._v(" 编辑 ")]),a("CButton",{attrs:{color:"primary",variant:"outline",square:"",size:"sm"},on:{click:function(t){return e.deleteBusinessCode(o,n)}}},[e._v(" 删除 ")])],1)]}},{key:"under-table",fn:function(){return[a("CPagination",{directives:[{name:"show",rawName:"v-show",value:e.pages>1,expression:"pages>1"}],attrs:{activePage:e.activePage,pages:e.pages},on:{"update:activePage":function(t){e.activePage=t},"update:active-page":function(t){e.activePage=t},"my-page-change":e.onPageChange}})]},proxy:!0}])})],1),a("CModal",{attrs:{title:"编辑/新增 业务编码",color:"primary",show:e.openModal},on:{"update:show":function(t){e.openModal=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:e.hideModal}},[e._v(" Cancel ")]),a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:e.saveBusinessCode}},[e._v(" OK ")])]},proxy:!0}])},[[a("div",[a("CRow",[a("CCol",{attrs:{sm:"6"}},[a("CSelect",{attrs:{label:"模块",options:Object.values(e.moduleSelectOptionMap),value:e.model.moduleCode},on:{"update:value":function(t){return e.$set(e.model,"moduleCode",t)}}})],1),a("CCol",{attrs:{sm:"6"}},[a("CSelect",{attrs:{label:"类型",options:Object.values(e.typeSelectOptionMap),value:e.model.typeCode},on:{"update:value":function(t){return e.$set(e.model,"typeCode",t)}}})],1)],1),a("CRow",[a("CCol",{attrs:{sm:"12"}},[a("CInput",{attrs:{label:"标题",placeholder:"建议见名知意",value:e.model.title},on:{"update:value":function(t){return e.$set(e.model,"title",t)}}})],1)],1),a("CRow",[a("CCol",{attrs:{sm:"12"}},[a("CInput",{attrs:{label:"常量符号",placeholder:"建议大写",value:e.model.name},on:{"update:value":function(t){return e.$set(e.model,"name",t)}}})],1)],1),a("CRow",[a("CCol",{attrs:{sm:"12"}},[a("CTextarea",{attrs:{label:"说明",placeholder:"业务错误码简要说明",value:e.model.description},on:{"update:value":function(t){return e.$set(e.model,"description",t)}}})],1)],1)],1)]],2),a("CElementCover",{directives:[{name:"show",rawName:"v-show",value:e.ajaxDoing,expression:"ajaxDoing"}],attrs:{boundaries:[{sides:["top","left"]}],opacity:.8}},[a("h1",{staticClass:"d-inline"},[e._v("Loading... ")]),a("CSpinner",{attrs:{size:"5xl",color:"success"}})],1)],1)},n=[],i=a("bc3a"),r=a.n(i);function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var u=[{key:"id",label:"ID",filter:!1},{key:"moduleCode",label:"模块",sorter:!1},{key:"typeCode",label:"类型",sorter:!1},{key:"title",label:"标题",sorter:!1},{key:"code",label:"数字代码"},{key:"name",label:"常量表达式",sorter:!1},{key:"description",label:"说明",sorter:!1},{key:"status",label:"状态"},{key:"action",label:"操作",sorter:!1,filter:!1}],d=function(e){return"".concat(host).concat(e)},p={name:"CodeList",data:function(){return{sorter:{external:!0,resetable:!0},activePage:1,pages:1,perPage:5,sorterMap:{},filterMap:{},ajaxDoing:!1,openModal:!1,items:[],formatItems:[],moduleSelectOptionMap:{},typeSelectOptionMap:{},model:{id:0,moduleCode:"",typeCode:"",name:"",title:"",code:"",description:"",status:"",createTime:"",updateTime:""},fields:u,details:[],collapseDuration:0}},watch:{activePage:function(e){this.onPageChange(e)}},computed:{},mounted:function(){var e=this;r.a.get("".concat(host,"/api/v1/module/all")).then((function(t){var a={};t.data.forEach((function(e){a[e.code]={label:e.title,value:e.code}})),e.moduleSelectOptionMap=a})),r.a.get("".concat(host,"/api/v1/type/all")).then((function(t){var a={};t.data.forEach((function(e){a[e.code]={label:e.title,value:e.code}})),e.typeSelectOptionMap=a})),this.getList()},methods:{formatRow:function(e){var t=l({},e),a=e["moduleCode"],o=this.moduleSelectOptionMap[a];o&&(t["moduleCode"]=o["label"]+"("+o["value"]+")");var n=e["typeCode"],i=this.typeSelectOptionMap[n];return i&&(t["typeCode"]=i["label"]+"("+i["value"]+")"),t},hideModal:function(e){this.openModal=!1},showModal:function(){this.openModal=!0},queryString:function(e){var t={},a={size:this.perPage,page:this.activePage},o=this.sorterMap,n={},i=[];return Object.keys(o).forEach((function(e){var t=o[e];t&&i.push(e+" "+t)})),i.length>0&&(n["order"]=i.join(",")),Object.assign(t,this.filterMap,n,a,e),Object.keys(t).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])})).join("&")},onPageChange:function(e){this.activePage=e,this.getList()},onSorterValue:function(e){var t=e.column,a=e.asc;if(t){var o=!0===a?"asc":!1===a?"desc":null;o?this.sorterMap[t]=o:delete this.sorterMap[t]}this.getList()},onColumnFilterValue:function(e){var t=this;Object.keys(e).forEach((function(a){t.filterMap[a]=e[a]})),this.getList()},getList:function(){var e=this,t=this.queryString();this.ajaxDoing=!0,r.a.get("".concat(host,"/api/v1/code/list?").concat(t)).then((function(t){var a=t.data,o=a.items,n=a.pagination,i=n.size,r=n.page,s=n.total;e.items=o,e.formatItems=o.map(e.formatRow),e.perPage=i,e.activePage=r,e.pages=Math.ceil(s/i),e.ajaxDoing=!1}))},saveBusinessCode:function(){var e=this;this.ajaxDoing=!0;var t=this.model,a=t.id?d("/api/v1/code/update"):d("/api/v1/code/create"),o=t.id?"put":"post";return console.log("create",t),r.a[o](a,t).then((function(t){e.ajaxDoing=!1,e.hideModal(),location.reload()})),!1},editBusinessCode:function(e){var t=this;this.showModal();var a=e.id,o=d("/api/v1/code/get?id=".concat(a));return r.a.get(o).then((function(e){t.model=e.data,t.ajaxDoing=!1})),!1},deleteBusinessCode:function(e){var t=this;this.ajaxDoing=!0;var a=e.id,o=d("/api/v1/code/delete?id=".concat(a));return r.a.delete(o).then((function(e){t.ajaxDoing=!1,location.reload()})),!1},getBadge:function(e){switch(e){case"ON":return"success";case"OFF":return"warning";default:}}}},f=p,v=a("4023"),m=Object(v["a"])(f,o,n,!1,null,null,null);t["default"]=m.exports}}]);
//# sourceMappingURL=chunk-2d0f0630.7ceabb21.js.map